<?php

use System\Libraries\Session;
use App\Libraries\Fastlang as Flang;

if (Session::has_flash('success')) {
    $success = Session::flash('success');
}
if (Session::has_flash('error')) {
    $error = Session::flash('error');
}

$email = Session::get('email') ?? null;
$fullname = Session::get('fullname') ?? null;

?>

<div class="container">
    <div class="top-nav relative mt-3 flex justify-between">
        <div class="back">
            <a href="#" class="flex items-center justify-center w-10 h-10 rounded-full bg-grey text-white">
                <svg width="11" height="18" viewBox="0 0 11 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M0.225806 9L8.97581 17.75L10.2008 16.525L2.67581 9L10.2008 1.475L8.97581 0.25L0.225806 9Z"
                        fill="white" />
                </svg>
            </a>
        </div>
        <div class="setting">
            <a href="#" class="flex items-center justify-center w-10 h-10 rounded-full bg-grey text-white">
                <svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M13.9999 8.75C14.9664 8.75 15.7499 7.9665 15.7499 7C15.7499 6.0335 14.9664 5.25 13.9999 5.25C13.0334 5.25 12.2499 6.0335 12.2499 7C12.2499 7.9665 13.0334 8.75 13.9999 8.75Z"
                        fill="white" />
                    <path
                        d="M13.9999 15.75C14.9664 15.75 15.7499 14.9665 15.7499 14C15.7499 13.0335 14.9664 12.25 13.9999 12.25C13.0334 12.25 12.2499 13.0335 12.2499 14C12.2499 14.9665 13.0334 15.75 13.9999 15.75Z"
                        fill="white" />
                    <path
                        d="M13.9999 22.75C14.9664 22.75 15.7499 21.9665 15.7499 21C15.7499 20.0335 14.9664 19.25 13.9999 19.25C13.0334 19.25 12.2499 20.0335 12.2499 21C12.2499 21.9665 13.0334 22.75 13.9999 22.75Z"
                        fill="white" />
                </svg>
            </a>
        </div>
    </div>
    <div class="form p-4">
        <div class="head-form p-6">
            <div class="title font-semibold text-2xl text-center text-gray-200 mb-3">
                <?= Flang::_e('set_password') ?>
            </div>

        </div>
        <?php if (!empty($success)): ?>
        <div class="bg-green-100 text-green-800 p-4 mb-4 rounded">
            <?= $success; ?>
        </div>
        <?php elseif (!empty($error)): ?>
        <div class="bg-red-200 text-red-800 p-4 mb-4 rounded">
            <?= $error; ?>
        </div>
        <?php endif; ?>
        <form action="" name="loginForm" class="py-6 flex flex-col gap-4" method="post">
            <input type="hidden" name="csrf_token" value="<?= $csrf_token; ?>">


            <!-- Password Field -->
            <div x-data="{ showPassword: false }" class="fieldset">
                <div class="field password">
                    <input :type="showPassword ? 'text' : 'password'" name="password" id="password" value="1234567"
                        placeholder="<?= Flang::_e('plc_new_password') ?>" class="" required="">
                    <span @click="showPassword = !showPassword"
                        class="absolute inset-y-0 right-0 px-3 py-2 flex items-center text-gray-600 focus:outline-none cursor-pointer"
                        :class="{'text-gray-600': !showPassword, 'text-white': showPassword}">
                        <svg x-show="!showPassword" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M22.5303 1.46967C22.8232 1.76256 22.8232 2.23744 22.5303 2.53033L2.53033 22.5303C2.23744 22.8232 1.76256 22.8232 1.46967 22.5303C1.17678 22.2374 1.17678 21.7626 1.46967 21.4697L4.84014 18.0992C3.88593 17.2323 3.01279 16.1886 2.25746 15.003C1.71229 14.1486 1.465 13.054 1.465 12.005C1.465 10.956 1.7123 9.86138 2.25749 9.00696C4.64841 5.2486 8.15202 2.98 12 2.98C14.1337 2.98 16.183 3.68491 17.9808 4.95856L21.4697 1.46967C21.7626 1.17678 22.2374 1.17678 22.5303 1.46967ZM16.9025 6.03681C15.3877 5.01887 13.7128 4.48 12 4.48C8.78815 4.48 5.71189 6.3712 3.52282 9.81254L3.52219 9.81353C3.16761 10.369 2.965 11.1642 2.965 12.005C2.965 12.8458 3.16761 13.641 3.52219 14.1965C4.22577 15.3008 5.0334 16.2574 5.90217 17.0372L8.45502 14.4843C7.96047 13.7816 7.67 12.9266 7.67 12C7.67 9.60579 9.60579 7.67 12 7.67C12.9266 7.67 13.7816 7.96047 14.4843 8.45502L16.9025 6.03681ZM13.399 9.54029C12.9865 9.30393 12.5104 9.17 12 9.17C10.4342 9.17 9.17 10.4342 9.17 12C9.17 12.5104 9.30393 12.9865 9.54029 13.399L13.399 9.54029ZM19.5799 7.34559C19.9027 7.08598 20.3748 7.13717 20.6344 7.45993C21.0183 7.9372 21.3954 8.45005 21.7432 8.99813C22.2879 9.85237 22.535 10.9464 22.535 11.995C22.535 13.0438 22.2878 14.1382 21.7428 14.9925C19.3519 18.7512 15.8481 21.02 12 21.02C10.6635 21.02 9.35483 20.7374 8.12896 20.2212C7.7472 20.0605 7.56804 19.6207 7.72877 19.239C7.88951 18.8572 8.32929 18.678 8.71104 18.8388C9.76517 19.2826 10.8765 19.52 12 19.52C15.2119 19.52 18.2881 17.6288 20.4772 14.1875L20.4778 14.1865C20.8324 13.631 21.035 12.8358 21.035 11.995C21.035 11.1542 20.8324 10.359 20.4778 9.80353L20.4768 9.80187C20.1646 9.30995 19.8217 8.8428 19.4656 8.40007C19.206 8.07731 19.2572 7.6052 19.5799 7.34559ZM15.646 11.9624C16.0534 12.0375 16.3227 12.4287 16.2476 12.836C15.9312 14.5519 14.5419 15.9412 12.826 16.2576C12.4187 16.3327 12.0275 16.0634 11.9524 15.656C11.8773 15.2487 12.1466 14.8575 12.554 14.7824C13.6581 14.5788 14.5688 13.6681 14.7724 12.564C14.8475 12.1566 15.2387 11.8873 15.646 11.9624Z"
                                fill="currentcolor" />
                        </svg>
                        <svg x-show="showPassword" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M12 4.5C7.30558 4.5 3.14841 7.2486 1.25749 12C1.7123 13.1386 2.25749 14.1386 2.25749 14.1386C4.64841 17.897 8.15202 20.1654 12 20.1654C16.6944 20.1654 20.8516 17.4168 22.7425 12.6654C22.2877 11.5268 21.7425 10.5268 21.7425 10.5268C19.3516 6.76841 15.848 4.5 12 4.5ZM12 18.6654C8.78815 18.6654 5.71189 16.7742 3.52282 13.3329C3.16761 12.7774 2.965 11.9822 2.965 11.1414C2.965 10.3006 3.16761 9.5054 3.52282 8.94993C5.71189 5.5086 8.78815 3.6174 12 3.6174C15.2119 3.6174 18.2881 5.5086 20.4772 8.94993C20.8324 9.5054 21.035 10.3006 21.035 11.1414C21.035 11.9822 20.8324 12.7774 20.4772 13.3329C18.2881 16.7742 15.2119 18.6654 12 18.6654ZM12 7.5C10.067 7.5 8.5 9.067 8.5 11C8.5 12.933 10.067 14.5 12 14.5C13.933 14.5 15.5 12.933 15.5 11C15.5 9.067 13.933 7.5 12 7.5ZM12 13C10.8954 13 10 12.1046 10 11C10 9.89543 10.8954 9 12 9C13.1046 9 14 9.89543 14 11C14 12.1046 13.1046 13 12 13Z"
                                fill="currentcolor" />
                        </svg>
                    </span>
                </div>
            </div>
            <?php if (!empty($errors['password_verify'])): ?>
            <div class="text-red-500 mt-2 text-sm">
                <?php foreach ($errors['password_verify'] as $error): ?>
                <p><?= $error; ?></p>
                <?php endforeach; ?>
            </div>
            <?php endif; ?>
            <!-- Password Verify Field -->
            <div x-data="{ showPassword: false }" class="fieldset">
                <div class="field confirm-password">
                    <input :type="showPassword ? 'text' : 'password'" name="confirm-password" id="confirm-password"
                        value="1234567" placeholder="<?= Flang::_e('plc_re_new_password') ?>" class="" required="">
                    <span @click="showPassword = !showPassword"
                        class="absolute inset-y-0 right-0 px-3 py-2 flex items-center text-gray-600 focus:outline-none cursor-pointer"
                        :class="{'text-gray-600': !showPassword, 'text-white': showPassword}">
                        <svg x-show="!showPassword" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M22.5303 1.46967C22.8232 1.76256 22.8232 2.23744 22.5303 2.53033L2.53033 22.5303C2.23744 22.8232 1.76256 22.8232 1.46967 22.5303C1.17678 22.2374 1.17678 21.7626 1.46967 21.4697L4.84014 18.0992C3.88593 17.2323 3.01279 16.1886 2.25746 15.003C1.71229 14.1486 1.465 13.054 1.465 12.005C1.465 10.956 1.7123 9.86138 2.25749 9.00696C4.64841 5.2486 8.15202 2.98 12 2.98C14.1337 2.98 16.183 3.68491 17.9808 4.95856L21.4697 1.46967C21.7626 1.17678 22.2374 1.17678 22.5303 1.46967ZM16.9025 6.03681C15.3877 5.01887 13.7128 4.48 12 4.48C8.78815 4.48 5.71189 6.3712 3.52282 9.81254L3.52219 9.81353C3.16761 10.369 2.965 11.1642 2.965 12.005C2.965 12.8458 3.16761 13.641 3.52219 14.1965C4.22577 15.3008 5.0334 16.2574 5.90217 17.0372L8.45502 14.4843C7.96047 13.7816 7.67 12.9266 7.67 12C7.67 9.60579 9.60579 7.67 12 7.67C12.9266 7.67 13.7816 7.96047 14.4843 8.45502L16.9025 6.03681ZM13.399 9.54029C12.9865 9.30393 12.5104 9.17 12 9.17C10.4342 9.17 9.17 10.4342 9.17 12C9.17 12.5104 9.30393 12.9865 9.54029 13.399L13.399 9.54029ZM19.5799 7.34559C19.9027 7.08598 20.3748 7.13717 20.6344 7.45993C21.0183 7.9372 21.3954 8.45005 21.7432 8.99813C22.2879 9.85237 22.535 10.9464 22.535 11.995C22.535 13.0438 22.2878 14.1382 21.7428 14.9925C19.3519 18.7512 15.8481 21.02 12 21.02C10.6635 21.02 9.35483 20.7374 8.12896 20.2212C7.7472 20.0605 7.56804 19.6207 7.72877 19.239C7.88951 18.8572 8.32929 18.678 8.71104 18.8388C9.76517 19.2826 10.8765 19.52 12 19.52C15.2119 19.52 18.2881 17.6288 20.4772 14.1875L20.4778 14.1865C20.8324 13.631 21.035 12.8358 21.035 11.995C21.035 11.1542 20.8324 10.359 20.4778 9.80353L20.4768 9.80187C20.1646 9.30995 19.8217 8.8428 19.4656 8.40007C19.206 8.07731 19.2572 7.6052 19.5799 7.34559ZM15.646 11.9624C16.0534 12.0375 16.3227 12.4287 16.2476 12.836C15.9312 14.5519 14.5419 15.9412 12.826 16.2576C12.4187 16.3327 12.0275 16.0634 11.9524 15.656C11.8773 15.2487 12.1466 14.8575 12.554 14.7824C13.6581 14.5788 14.5688 13.6681 14.7724 12.564C14.8475 12.1566 15.2387 11.8873 15.646 11.9624Z"
                                fill="currentcolor" />
                        </svg>
                        <svg x-show="showPassword" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M12 4.5C7.30558 4.5 3.14841 7.2486 1.25749 12C1.7123 13.1386 2.25749 14.1386 2.25749 14.1386C4.64841 17.897 8.15202 20.1654 12 20.1654C16.6944 20.1654 20.8516 17.4168 22.7425 12.6654C22.2877 11.5268 21.7425 10.5268 21.7425 10.5268C19.3516 6.76841 15.848 4.5 12 4.5ZM12 18.6654C8.78815 18.6654 5.71189 16.7742 3.52282 13.3329C3.16761 12.7774 2.965 11.9822 2.965 11.1414C2.965 10.3006 3.16761 9.5054 3.52282 8.94993C5.71189 5.5086 8.78815 3.6174 12 3.6174C15.2119 3.6174 18.2881 5.5086 20.4772 8.94993C20.8324 9.5054 21.035 10.3006 21.035 11.1414C21.035 11.9822 20.8324 12.7774 20.4772 13.3329C18.2881 16.7742 15.2119 18.6654 12 18.6654ZM12 7.5C10.067 7.5 8.5 9.067 8.5 11C8.5 12.933 10.067 14.5 12 14.5C13.933 14.5 15.5 12.933 15.5 11C15.5 9.067 13.933 7.5 12 7.5ZM12 13C10.8954 13 10 12.1046 10 11C10 9.89543 10.8954 9 12 9C13.1046 9 14 9.89543 14 11C14 12.1046 13.1046 13 12 13Z"
                                fill="currentcolor" />
                        </svg>
                    </span>
                </div>
            </div>
            <?php if (!empty($errors['fullname'])): ?>
            <div class="text-red-500 mt-2 text-sm">
                <?php foreach ($errors['fullname'] as $error): ?>
                <p><?= $error; ?></p>
                <?php endforeach; ?>
            </div>
            <?php endif; ?>
            <div class="fieldset flex flex-col gap-4">
                <div class="action flex justify-center">
                    <button type="submit" class="btn btn-primary rounded-full">
                        <?= Flang::_e('submit_request') ?>
                    </button>
                </div>
            </div>

        </form>
    </div>
</div>
